{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}
    {% if ata %}Editar{% else %}Nova{% endif %} Ata de Reunião - Editor Personalizado - ABMEPI
{% endblock %}

{% block extra_css %}
<style>
    /* Estilos do Editor Personalizado */
    .editor-container {
        margin-bottom: 2rem;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .editor-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .editor-title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 600;
    }

    .editor-toolbar {
        background: #f8f9fa;
        border-bottom: 1px solid #dee2e6;
        padding: 0.75rem;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
    }

    .toolbar-group {
        display: flex;
        gap: 0.25rem;
        align-items: center;
        padding-right: 1rem;
        border-right: 1px solid #dee2e6;
    }

    .toolbar-group:last-child {
        border-right: none;
    }

    .toolbar-btn {
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 0.5rem;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 0.9rem;
        min-width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .toolbar-btn:hover {
        background: #e9ecef;
        border-color: #adb5bd;
    }

    .toolbar-btn.active {
        background: #007bff;
        color: white;
        border-color: #007bff;
    }

    .toolbar-btn i {
        font-size: 0.9rem;
    }

    .editor-content {
        min-height: 500px;
        padding: 1.5rem;
        border: none;
        outline: none;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 14px;
        line-height: 1.6;
        background: white;
    }

    .editor-content:focus {
        outline: none;
    }

    .editor-content h1, .editor-content h2, .editor-content h3 {
        margin-top: 1.5rem;
        margin-bottom: 1rem;
        color: #333;
    }

    .editor-content h1 {
        font-size: 1.8rem;
        border-bottom: 2px solid #007bff;
        padding-bottom: 0.5rem;
    }

    .editor-content h2 {
        font-size: 1.5rem;
        color: #495057;
    }

    .editor-content h3 {
        font-size: 1.2rem;
        color: #6c757d;
    }

    .editor-content p {
        margin-bottom: 1rem;
    }

    .editor-content ul, .editor-content ol {
        margin-bottom: 1rem;
        padding-left: 2rem;
    }

    .editor-content li {
        margin-bottom: 0.5rem;
    }

    .editor-content table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1rem;
    }

    .editor-content table th,
    .editor-content table td {
        border: 1px solid #dee2e6;
        padding: 0.75rem;
        text-align: left;
    }

    .editor-content table th {
        background: #f8f9fa;
        font-weight: 600;
    }

    .editor-content blockquote {
        border-left: 4px solid #007bff;
        padding-left: 1rem;
        margin: 1rem 0;
        font-style: italic;
        color: #6c757d;
    }

    .editor-content code {
        background: #f8f9fa;
        padding: 0.2rem 0.4rem;
        border-radius: 3px;
        font-family: 'Courier New', monospace;
        font-size: 0.9rem;
    }

    .editor-content pre {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 4px;
        overflow-x: auto;
        margin-bottom: 1rem;
    }

    .editor-content pre code {
        background: none;
        padding: 0;
    }

    .word-count {
        background: #f8f9fa;
        border-top: 1px solid #dee2e6;
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
        color: #6c757d;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .status-indicator {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #28a745;
    }

    .status-dot.saving {
        background: #ffc107;
        animation: pulse 1s infinite;
    }

    .status-dot.error {
        background: #dc3545;
    }

    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }

    .form-section {
        background: white;
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .form-section h5 {
        color: #495057;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #e9ecef;
    }

    .btn-group-custom {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .btn-custom {
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        font-weight: 500;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.2s;
        border: none;
        cursor: pointer;
    }

    .btn-primary-custom {
        background: #007bff;
        color: white;
    }

    .btn-primary-custom:hover {
        background: #0056b3;
        color: white;
    }

    .btn-success-custom {
        background: #28a745;
        color: white;
    }

    .btn-success-custom:hover {
        background: #1e7e34;
        color: white;
    }

    .btn-secondary-custom {
        background: #6c757d;
        color: white;
    }

    .btn-secondary-custom:hover {
        background: #545b62;
        color: white;
    }

    .alert-custom {
        padding: 1rem;
        border-radius: 6px;
        margin-bottom: 1rem;
        border: 1px solid transparent;
    }

    .alert-info-custom {
        background: #d1ecf1;
        border-color: #bee5eb;
        color: #0c5460;
    }

    .form-control-custom {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 0.9rem;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }

    .form-control-custom:focus {
        border-color: #80bdff;
        outline: 0;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }

    .form-label-custom {
        font-weight: 600;
        color: #495057;
        margin-bottom: 0.5rem;
        display: block;
    }

    .form-group-custom {
        margin-bottom: 1rem;
    }

    .form-row-custom {
        display: flex;
        gap: 1rem;
    }

    .form-col-custom {
        flex: 1;
    }

    @media (max-width: 768px) {
        .form-row-custom {
            flex-direction: column;
        }
        
        .toolbar-group {
            flex-wrap: wrap;
        }
        
        .editor-toolbar {
            flex-direction: column;
            align-items: stretch;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <!-- Cabeçalho da página -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h1 class="h3 mb-0">
                        <i class="fas fa-edit me-2"></i>
                        {% if ata %}Editar{% else %}Nova{% endif %} Ata de Reunião
                    </h1>
                    <p class="text-muted mb-0">
                        Editor personalizado com formatação avançada
                    </p>
                </div>
                <div class="btn-group" role="group">
                    <a href="{% url 'diretoria:ata_list' %}" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>
                        Voltar para Lista
                    </a>
                </div>
            </div>

            <!-- Formulário principal -->
            <form method="post" enctype="multipart/form-data" id="ataForm">
                {% csrf_token %}
                
                <!-- Informações Básicas -->
                <div class="form-section">
                    <h5>
                        <i class="fas fa-info-circle me-2"></i>
                        Informações Básicas
                    </h5>
                    
                    <div class="form-row-custom">
                        <div class="form-col-custom">
                            <label for="{{ form.titulo.id_for_label }}" class="form-label-custom">
                                {{ form.titulo.label }}
                            </label>
                            {{ form.titulo }}
                            {% if form.titulo.errors %}
                                <div class="text-danger small mt-1">
                                    {% for error in form.titulo.errors %}
                                        <div>{{ error }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="form-col-custom">
                            <label for="{{ form.tipo_reuniao.id_for_label }}" class="form-label-custom">
                                {{ form.tipo_reuniao.label }}
                            </label>
                            {{ form.tipo_reuniao }}
                            {% if form.tipo_reuniao.errors %}
                                <div class="text-danger small mt-1">
                                    {% for error in form.tipo_reuniao.errors %}
                                        <div>{{ error }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="form-row-custom">
                        <div class="form-col-custom">
                            <label for="{{ form.data_reuniao.id_for_label }}" class="form-label-custom">
                                {{ form.data_reuniao.label }}
                            </label>
                            {{ form.data_reuniao }}
                            {% if form.data_reuniao.errors %}
                                <div class="text-danger small mt-1">
                                    {% for error in form.data_reuniao.errors %}
                                        <div>{{ error }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="form-col-custom">
                            <label for="{{ form.local.id_for_label }}" class="form-label-custom">
                                {{ form.local.label }}
                            </label>
                            {{ form.local }}
                            {% if form.local.errors %}
                                <div class="text-danger small mt-1">
                                    {% for error in form.local.errors %}
                                        <div>{{ error }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Participantes -->
                <div class="form-section">
                    <h5>
                        <i class="fas fa-users me-2"></i>
                        Participantes
                    </h5>
                    
                    <div class="form-row-custom">
                        <div class="form-col-custom">
                            <label for="{{ form.presidente.id_for_label }}" class="form-label-custom">
                                {{ form.presidente.label }}
                            </label>
                            {{ form.presidente }}
                            {% if form.presidente.errors %}
                                <div class="text-danger small mt-1">
                                    {% for error in form.presidente.errors %}
                                        <div>{{ error }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="form-col-custom">
                            <label for="{{ form.secretario.id_for_label }}" class="form-label-custom">
                                {{ form.secretario.label }}
                            </label>
                            {{ form.secretario }}
                            {% if form.secretario.errors %}
                                <div class="text-danger small mt-1">
                                    {% for error in form.secretario.errors %}
                                        <div>{{ error }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="form-group-custom">
                        <label class="form-label-custom">
                            {{ form.membros_presentes.label }}
                        </label>
                        {{ form.membros_presentes }}
                        {% if form.membros_presentes.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.membros_presentes.errors %}
                                    <div>{{ error }}</div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group-custom">
                        <label class="form-label-custom">
                            {{ form.membros_ausentes.label }}
                        </label>
                        {{ form.membros_ausentes }}
                        {% if form.membros_ausentes.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.membros_ausentes.errors %}
                                    <div>{{ error }}</div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Conteúdo da Ata -->
                <div class="form-section">
                    <h5>
                        <i class="fas fa-file-alt me-2"></i>
                        Conteúdo da Ata
                    </h5>
                    
                    <div class="form-group-custom">
                        <label for="{{ form.pauta.id_for_label }}" class="form-label-custom">
                            {{ form.pauta.label }}
                        </label>
                        {{ form.pauta }}
                        {% if form.pauta.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.pauta.errors %}
                                    <div>{{ error }}</div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group-custom">
                        <label for="{{ form.deliberacoes.id_for_label }}" class="form-label-custom">
                            {{ form.deliberacoes.label }}
                        </label>
                        {{ form.deliberacoes }}
                        {% if form.deliberacoes.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.deliberacoes.errors %}
                                    <div>{{ error }}</div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group-custom">
                        <label for="{{ form.observacoes.id_for_label }}" class="form-label-custom">
                            {{ form.observacoes.label }}
                        </label>
                        {{ form.observacoes }}
                        {% if form.observacoes.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.observacoes.errors %}
                                    <div>{{ error }}</div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Editor Principal -->
                <div class="form-section">
                    <h5>
                        <i class="fas fa-edit me-2"></i>
                        Editor de Conteúdo Completo
                    </h5>
                    
                    <div class="editor-container">
                        <div class="editor-header">
                            <h6 class="editor-title">
                                <i class="fas fa-magic me-2"></i>
                                Editor Personalizado
                            </h6>
                            <div class="status-indicator">
                                <div class="status-dot" id="statusDot"></div>
                                <span id="statusText">Pronto</span>
                            </div>
                        </div>
                        
                        <div class="editor-toolbar">
                            <!-- Formatação de Texto -->
                            <div class="toolbar-group">
                                <button type="button" class="toolbar-btn" onclick="execCommand('bold')" title="Negrito">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('italic')" title="Itálico">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('underline')" title="Sublinhado">
                                    <i class="fas fa-underline"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('strikeThrough')" title="Riscado">
                                    <i class="fas fa-strikethrough"></i>
                                </button>
                            </div>
                            
                            <!-- Cabeçalhos -->
                            <div class="toolbar-group">
                                <button type="button" class="toolbar-btn" onclick="execCommand('formatBlock', 'h1')" title="Título 1">
                                    H1
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('formatBlock', 'h2')" title="Título 2">
                                    H2
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('formatBlock', 'h3')" title="Título 3">
                                    H3
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('formatBlock', 'p')" title="Parágrafo">
                                    P
                                </button>
                            </div>
                            
                            <!-- Listas -->
                            <div class="toolbar-group">
                                <button type="button" class="toolbar-btn" onclick="execCommand('insertUnorderedList')" title="Lista com marcadores">
                                    <i class="fas fa-list-ul"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('insertOrderedList')" title="Lista numerada">
                                    <i class="fas fa-list-ol"></i>
                                </button>
                            </div>
                            
                            <!-- Alinhamento -->
                            <div class="toolbar-group">
                                <button type="button" class="toolbar-btn" onclick="execCommand('justifyLeft')" title="Alinhar à esquerda">
                                    <i class="fas fa-align-left"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('justifyCenter')" title="Centralizar">
                                    <i class="fas fa-align-center"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('justifyRight')" title="Alinhar à direita">
                                    <i class="fas fa-align-right"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('justifyFull')" title="Justificar">
                                    <i class="fas fa-align-justify"></i>
                                </button>
                            </div>
                            
                            <!-- Inserir -->
                            <div class="toolbar-group">
                                <button type="button" class="toolbar-btn" onclick="insertTable()" title="Inserir tabela">
                                    <i class="fas fa-table"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="insertLink()" title="Inserir link">
                                    <i class="fas fa-link"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="insertHorizontalRule()" title="Inserir linha horizontal">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                            
                            <!-- Ações -->
                            <div class="toolbar-group">
                                <button type="button" class="toolbar-btn" onclick="execCommand('undo')" title="Desfazer">
                                    <i class="fas fa-undo"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="execCommand('redo')" title="Refazer">
                                    <i class="fas fa-redo"></i>
                                </button>
                                <button type="button" class="toolbar-btn" onclick="clearFormatting()" title="Limpar formatação">
                                    <i class="fas fa-remove-format"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div 
                            id="editorContent" 
                            class="editor-content" 
                            contenteditable="true"
                            data-placeholder="Digite o conteúdo da ata aqui..."
                        >{{ form.conteudo_completo.value|default:"" }}</div>
                        
                        <div class="word-count">
                            <div>
                                <span id="wordCount">0</span> palavras | 
                                <span id="charCount">0</span> caracteres
                            </div>
                            <div class="status-indicator">
                                <div class="status-dot" id="autoSaveStatus"></div>
                                <span id="autoSaveText">Salvamento automático ativo</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Campo oculto para o conteúdo -->
                    <textarea name="conteudo_completo" id="id_conteudo_completo" style="display: none;">{{ form.conteudo_completo.value|default:"" }}</textarea>
                </div>

                <!-- Arquivo da Ata -->
                <div class="form-section">
                    <h5>
                        <i class="fas fa-paperclip me-2"></i>
                        Arquivo da Ata
                    </h5>
                    
                    <div class="form-group-custom">
                        <label for="{{ form.arquivo_ata.id_for_label }}" class="form-label-custom">
                            {{ form.arquivo_ata.label }}
                        </label>
                        {{ form.arquivo_ata }}
                        {% if form.arquivo_ata.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.arquivo_ata.errors %}
                                    <div>{{ error }}</div>
                                {% endfor %}
                            </div>
                        {% endif %}
                        {% if ata.arquivo_ata %}
                            <div class="mt-2">
                                <small class="text-muted">
                                    Arquivo atual: 
                                    <a href="{{ ata.arquivo_ata.url }}" target="_blank">
                                        {{ ata.arquivo_ata.name|filename }}
                                    </a>
                                </small>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Botões de Ação -->
                <div class="form-section">
                    <div class="btn-group-custom">
                        <button type="submit" class="btn-custom btn-primary-custom">
                            <i class="fas fa-save me-2"></i>
                            {% if ata %}Atualizar Ata{% else %}Criar Ata{% endif %}
                        </button>
                        
                        {% if ata %}
                        <button type="button" class="btn-custom btn-success-custom" onclick="assinarAta()">
                            <i class="fas fa-signature me-2"></i>
                            Assinar Ata
                        </button>
                        {% endif %}
                        
                        <a href="{% url 'diretoria:ata_list' %}" class="btn-custom btn-secondary-custom">
                            <i class="fas fa-times me-2"></i>
                            Cancelar
                        </a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const editor = document.getElementById('editorContent');
    const hiddenField = document.getElementById('id_conteudo_completo');
    const wordCount = document.getElementById('wordCount');
    const charCount = document.getElementById('charCount');
    const statusDot = document.getElementById('statusDot');
    const statusText = document.getElementById('statusText');
    const autoSaveStatus = document.getElementById('autoSaveStatus');
    const autoSaveText = document.getElementById('autoSaveText');
    
    let autoSaveInterval;
    let isSaving = false;
    
    // Configurar placeholder
    editor.addEventListener('focus', function() {
        if (this.textContent.trim() === '') {
            this.innerHTML = '';
        }
    });
    
    editor.addEventListener('blur', function() {
        if (this.textContent.trim() === '') {
            this.innerHTML = '<p><br></p>';
        }
    });
    
    // Atualizar contadores
    function updateCounters() {
        const text = editor.textContent || '';
        const words = text.trim().split(/\s+/).filter(word => word.length > 0).length;
        const chars = text.length;
        
        wordCount.textContent = words;
        charCount.textContent = chars;
    }
    
    // Salvar conteúdo no campo oculto
    function saveContent() {
        hiddenField.value = editor.innerHTML;
    }
    
    // Atualizar status
    function updateStatus(status, text) {
        statusDot.className = `status-dot ${status}`;
        statusText.textContent = text;
    }
    
    // Salvamento automático
    function autoSave() {
        if (isSaving) return;
        
        isSaving = true;
        updateStatus('saving', 'Salvando...');
        
        saveContent();
        
        // Simular salvamento (aqui você pode implementar AJAX)
        setTimeout(() => {
            isSaving = false;
            updateStatus('', 'Salvo automaticamente');
            autoSaveStatus.className = 'status-dot';
            autoSaveText.textContent = 'Salvamento automático ativo';
        }, 1000);
    }
    
    // Event listeners
    editor.addEventListener('input', function() {
        updateCounters();
        saveContent();
        
        // Resetar status após 3 segundos
        setTimeout(() => {
            if (!isSaving) {
                updateStatus('', 'Pronto');
            }
        }, 3000);
    });
    
    editor.addEventListener('keydown', function(e) {
        // Ctrl+S para salvar
        if (e.ctrlKey && e.key === 's') {
            e.preventDefault();
            document.getElementById('ataForm').submit();
        }
    });
    
    // Iniciar salvamento automático a cada 30 segundos
    autoSaveInterval = setInterval(autoSave, 30000);
    
    // Inicializar contadores
    updateCounters();
    
    // Configurar placeholders para campos de texto
    const textareas = document.querySelectorAll('textarea');
    textareas.forEach(textarea => {
        if (textarea.value.trim() === '') {
            textarea.placeholder = textarea.getAttribute('placeholder') || 'Digite aqui...';
        }
    });
});

// Funções do editor
function execCommand(command, value = null) {
    const editor = document.getElementById('editorContent');
    editor.focus();
    
    if (value) {
        document.execCommand(command, false, value);
    } else {
        document.execCommand(command, false);
    }
    
    // Atualizar contadores
    updateCounters();
}

function insertTable() {
    const editor = document.getElementById('editorContent');
    editor.focus();
    
    const rows = prompt('Número de linhas:', '3');
    const cols = prompt('Número de colunas:', '3');
    
    if (rows && cols) {
        let table = '<table border="1" style="border-collapse: collapse; width: 100%;">';
        for (let i = 0; i < rows; i++) {
            table += '<tr>';
            for (let j = 0; j < cols; j++) {
                table += '<td style="padding: 8px;">&nbsp;</td>';
            }
            table += '</tr>';
        }
        table += '</table>';
        
        document.execCommand('insertHTML', false, table);
    }
}

function insertLink() {
    const url = prompt('URL do link:', 'https://');
    if (url) {
        const text = prompt('Texto do link:', url);
        document.execCommand('createLink', false, url);
    }
}

function insertHorizontalRule() {
    document.execCommand('insertHTML', false, '<hr>');
}

function clearFormatting() {
    const editor = document.getElementById('editorContent');
    const selection = window.getSelection();
    
    if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        const contents = range.extractContents();
        const text = contents.textContent;
        
        range.insertNode(document.createTextNode(text));
        selection.removeAllRanges();
        selection.addRange(range);
    }
}

function assinarAta() {
    if (confirm('Tem certeza que deseja assinar esta ata? Esta ação não pode ser desfeita.')) {
        // Aqui você pode implementar a lógica de assinatura
        alert('Funcionalidade de assinatura será implementada em breve.');
    }
}

function updateCounters() {
    const editor = document.getElementById('editorContent');
    const wordCount = document.getElementById('wordCount');
    const charCount = document.getElementById('charCount');
    
    const text = editor.textContent || '';
    const words = text.trim().split(/\s+/).filter(word => word.length > 0).length;
    const chars = text.length;
    
    wordCount.textContent = words;
    charCount.textContent = chars;
}
</script>
{% endblock %}
